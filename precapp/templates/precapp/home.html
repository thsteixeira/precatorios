{% extends 'base.html' %}

{% block title %}Dashboard - Controle de Precatórios{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="row">
    <div class="col-12">
        <div class="jumbotron bg-light p-5 rounded-lg mb-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4">
                        <i class="fas fa-gavel text-primary me-3"></i>
                        Sistema de Controle de Precatórios
                    </h1>
                    <p class="lead">Gerencie precatórios, clientes, alvarás, requerimentos e diligências com sistema completo de fases, filtros avançados e gestão de tarefas.</p>
                    <hr class="my-4">
                    <p>Controle completo do processo judicial desde o precatório até a emissão de alvarás, incluindo gestão de requerimentos, fases personalizadas e sistema de diligências para acompanhamento de tarefas.</p>
                </div>
                <div class="col-md-4 text-center">
                    <i class="fas fa-balance-scale fa-5x text-primary opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Statistics Dashboard -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-4"><i class="fas fa-chart-bar text-primary me-2"></i>Visão Geral do Sistema</h3>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center border-primary">
            <div class="card-body">
                <i class="fas fa-gavel fa-3x text-primary mb-3"></i>
                <h2 class="text-primary">{{ total_precatorios }}</h2>
                <p class="card-text">Precatórios</p>
                <small class="text-muted">R$ {{ total_valor_precatorios|floatformat:2 }}</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-info">
            <div class="card-body">
                <i class="fas fa-users fa-3x text-info mb-3"></i>
                <h2 class="text-info">{{ total_clientes }}</h2>
                <p class="card-text">Clientes</p>
                <small class="text-muted">Cadastrados no sistema</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-success">
            <div class="card-body">
                <i class="fas fa-file-contract fa-3x text-success mb-3"></i>
                <h2 class="text-success">{{ total_alvaras }}</h2>
                <p class="card-text">Alvarás</p>
                <small class="text-muted">R$ {{ valor_alvaras|floatformat:2 }}</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-warning">
            <div class="card-body">
                <i class="fas fa-file-signature fa-3x text-warning mb-3"></i>
                <h2 class="text-warning">{{ total_requerimentos }}</h2>
                <p class="card-text">Requerimentos</p>
                <small class="text-muted">R$ {{ total_valor_requerimentos|floatformat:2 }}</small>
            </div>
        </div>
    </div>
</div>

<!-- Diligencias Statistics Row -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center border-dark">
            <div class="card-body">
                <i class="fas fa-tasks fa-3x text-dark mb-3"></i>
                <h2 class="text-dark">{{ total_diligencias }}</h2>
                <p class="card-text">Diligências</p>
                <small class="text-muted">{{ total_tipos_diligencia }} tipos ativos</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-info">
            <div class="card-body">
                <i class="fas fa-clock fa-3x text-info mb-3"></i>
                <h2 class="text-info">{{ diligencias_pendentes }}</h2>
                <p class="card-text">Pendentes</p>
                <small class="text-muted">Aguardando conclusão</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-success">
            <div class="card-body">
                <i class="fas fa-check-circle fa-3x text-success mb-3"></i>
                <h2 class="text-success">{{ diligencias_concluidas }}</h2>
                <p class="card-text">Concluídas</p>
                <small class="text-muted">Tarefas finalizadas</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center border-danger">
            <div class="card-body">
                <i class="fas fa-exclamation-triangle fa-3x text-danger mb-3"></i>
                <h2 class="text-danger">{{ diligencias_atrasadas }}</h2>
                <p class="card-text">Atrasadas</p>
                <small class="text-muted">{{ diligencias_urgentes }} urgentes</small>
            </div>
        </div>
    </div>
</div>

<!-- Main Features Grid -->
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-4"><i class="fas fa-star text-warning me-2"></i>Principais Funcionalidades</h3>
    </div>
</div>

<!-- Precatórios Section -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card h-100 border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-gavel me-2"></i>Gestão de Precatórios
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Controle completo dos precatórios com validação CNJ, filtros avançados e acompanhamento de valores.</p>
                <div class="row">
                    <div class="col-6">
                        <a href="{% url 'novo_precatorio' %}" class="btn btn-primary btn-block mb-2 w-100">
                            <i class="fas fa-plus me-1"></i>Novo Precatório
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'precatorios' %}" class="btn btn-outline-primary btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Todos
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card h-100 border-info">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-users me-2"></i>Gestão de Clientes
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Visualização e controle de clientes beneficiários com sistema de filtros avançados.</p>
                <div class="row">
                    <div class="col-6">
                        <a href="{% url 'novo_cliente' %}" class="btn btn-info btn-block mb-2 w-100">
                            <i class="fas fa-plus me-1"></i>Novo Cliente
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'clientes' %}" class="btn btn-outline-info btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Todos
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Alvarás and Requerimentos Section -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card h-100 border-success">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-file-contract me-2"></i>Gestão de Alvarás
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Emissão e controle de alvarás com sistema de fases personalizadas e filtros detalhados.</p>
                <div class="row">
                    <div class="col-12">
                        <a href="{% url 'alvaras' %}" class="btn btn-success btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Todos os Alvarás
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card h-100 border-warning">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">
                    <i class="fas fa-file-signature me-2"></i>Gestão de Requerimentos
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Controle completo de requerimentos com tipos de pedido específicos e fases personalizadas.</p>
                <div class="row">
                    <div class="col-12">
                        <a href="{% url 'requerimentos' %}" class="btn btn-warning btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Todos os Requerimentos
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Diligencias and Phase Management Section -->
<div class="row mb-4">
    <div class="col-md-6">
        <div class="card h-100 border-dark">
            <div class="card-header bg-dark text-white">
                <h5 class="mb-0">
                    <i class="fas fa-tasks me-2"></i>Gestão de Diligências
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Sistema completo de tarefas e acompanhamento de atividades por cliente com controle de prazos e urgências.</p>
                <div class="row">
                    <div class="col-6">
                        <a href="{% url 'diligencias_list' %}" class="btn btn-dark btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Diligências
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'tipos_diligencia' %}" class="btn btn-outline-dark btn-block mb-2 w-100">
                            <i class="fas fa-cog me-1"></i>Tipos
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card h-100 border-secondary">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>Sistema de Fases Personalizadas
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Crie e gerencie fases customizadas para alvarás e requerimentos com cores e descrições personalizadas.</p>
                <div class="row">
                    <div class="col-6">
                        <a href="{% url 'fases' %}" class="btn btn-secondary btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Fases
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{% url 'nova_fase' %}" class="btn btn-outline-secondary btn-block mb-2 w-100">
                            <i class="fas fa-plus me-1"></i>Nova Fase
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Legacy Phase Management Section (keeping for compatibility) -->
<div class="row mb-4" style="display: none;">
    <div class="col-md-12">
        <div class="card border-secondary">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-cogs me-2"></i>Sistema de Fases Personalizadas
                </h5>
            </div>
            <div class="card-body">
                <p class="card-text">Crie e gerencie fases customizadas para alvarás e requerimentos com cores e descrições personalizadas.</p>
                <div class="row">
                    <div class="col-md-4">
                        <a href="{% url 'fases' %}" class="btn btn-secondary btn-block mb-2 w-100">
                            <i class="fas fa-list me-1"></i>Ver Fases
                        </a>
                    </div>
                    <div class="col-md-4">
                        <a href="{% url 'nova_fase' %}" class="btn btn-outline-secondary btn-block mb-2 w-100">
                            <i class="fas fa-plus me-1"></i>Nova Fase
                        </a>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-outline-secondary btn-block w-100 disabled">
                            <i class="fas fa-chart-line me-1"></i>Relatórios (Em breve)
                        </button>
                    </div>
                </div>
                <div class="mt-3">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-muted">Fases para Alvarás:</h6>
                            <ul class="list-unstyled small">
                                <li><i class="fas fa-circle text-primary me-1"></i>Separadas por tipo de documento</li>
                                <li><i class="fas fa-circle text-primary me-1"></i>Cores personalizáveis</li>
                                <li><i class="fas fa-circle text-primary me-1"></i>Descrições detalhadas</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-muted">Fases para Requerimentos:</h6>
                            <ul class="list-unstyled small">
                                <li><i class="fas fa-circle text-warning me-1"></i>Sistema independente de alvarás</li>
                                <li><i class="fas fa-circle text-warning me-1"></i>Controle de workflow específico</li>
                                <li><i class="fas fa-circle text-warning me-1"></i>Acompanhamento de status</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Activity -->
{% if recent_precatorios or recent_alvaras or recent_requerimentos or recent_diligencias %}
<div class="row mb-4">
    <div class="col-12">
        <h3 class="mb-4"><i class="fas fa-clock text-info me-2"></i>Atividade Recente</h3>
    </div>
</div>

<div class="row mb-4">
    {% if recent_precatorios %}
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header bg-primary text-white">
                <h6 class="mb-0"><i class="fas fa-gavel me-2"></i>Últimos Precatórios</h6>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    {% for precatorio in recent_precatorios %}
                    <div class="list-group-item">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">{{ precatorio.cnj }}</div>
                                <small class="text-muted">{{ precatorio.origem|truncatechars:30 }}</small>
                            </div>
                            <span class="badge bg-primary rounded-pill">R$ {{ precatorio.valor_de_face|floatformat:0 }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {% if recent_alvaras %}
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h6 class="mb-0"><i class="fas fa-file-contract me-2"></i>Últimos Alvarás</h6>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    {% for alvara in recent_alvaras %}
                    <div class="list-group-item">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">{{ alvara.cliente.nome }}</div>
                                <small class="text-muted">{{ alvara.precatorio.cnj }}</small>
                            </div>
                            <span class="badge bg-success rounded-pill">{{ alvara.tipo }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {% if recent_requerimentos %}
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header bg-warning text-dark">
                <h6 class="mb-0"><i class="fas fa-file-signature me-2"></i>Últimos Requerimentos</h6>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    {% for requerimento in recent_requerimentos %}
                    <div class="list-group-item">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">{{ requerimento.cliente.nome }}</div>
                                <small class="text-muted">{{ requerimento.get_pedido_display }}</small>
                            </div>
                            <span class="badge bg-warning text-dark rounded-pill">R$ {{ requerimento.valor|floatformat:0 }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {% if recent_diligencias %}
    <div class="col-md-3">
        <div class="card h-100">
            <div class="card-header bg-dark text-white">
                <h6 class="mb-0"><i class="fas fa-tasks me-2"></i>Últimas Diligências</h6>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    {% for diligencia in recent_diligencias %}
                    <div class="list-group-item">
                        <div class="d-flex justify-content-between align-items-start">
                            <div class="ms-2 me-auto">
                                <div class="fw-bold">{{ diligencia.cliente.nome }}</div>
                                <small class="text-muted">{{ diligencia.tipo.nome }}</small>
                            </div>
                            <span class="badge {% if diligencia.concluida %}bg-success{% elif diligencia.is_overdue %}bg-danger{% elif diligencia.urgencia == 'alta' %}bg-warning{% else %}bg-secondary{% endif %} rounded-pill">
                                {% if diligencia.concluida %}Concluída{% elif diligencia.is_overdue %}Atrasada{% elif diligencia.urgencia == 'alta' %}Urgente{% else %}Pendente{% endif %}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- System Information -->
<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Funcionalidades Disponíveis
                </h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2"><i class="fas fa-chevron-right text-primary me-2"></i>Gestão completa de precatórios com filtros avançados</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-info me-2"></i>Controle de clientes com busca por múltiplos critérios</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-success me-2"></i>Sistema de alvarás com fases personalizadas</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-warning me-2"></i>Gestão de requerimentos com tipos específicos</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-dark me-2"></i>Sistema de diligências com controle de prazos</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-secondary me-2"></i>Sistema de fases customizáveis para documentos</li>
                    <li class="mb-2"><i class="fas fa-chevron-right text-danger me-2"></i>Filtros avançados em todas as listagens</li>
                    <li><i class="fas fa-chevron-right text-muted me-2"></i>Interface responsiva e moderna</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0">
                    <i class="fas fa-cog me-2"></i>Controles e Validações
                </h6>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2"><i class="fas fa-shield-alt text-primary me-2"></i>Validação rigorosa de CNJ</li>
                    <li class="mb-2"><i class="fas fa-calculator text-info me-2"></i>Controle de valores monetários</li>
                    <li class="mb-2"><i class="fas fa-calendar-check text-success me-2"></i>Gestão de datas e prazos</li>
                    <li class="mb-2"><i class="fas fa-user-shield text-warning me-2"></i>Controle de prioridades legais</li>
                    <li class="mb-2"><i class="fas fa-tasks text-dark me-2"></i>Sistema de tarefas com urgências</li>
                    <li class="mb-2"><i class="fas fa-link text-danger me-2"></i>Relacionamentos entre entidades</li>
                    <li class="mb-2"><i class="fas fa-palette text-secondary me-2"></i>Fases com cores personalizáveis</li>
                    <li><i class="fas fa-database text-muted me-2"></i>Armazenamento seguro de dados</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .jumbotron {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border: 1px solid #dee2e6;
    }
    
    .card {
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    
    .fa-5x {
        font-size: 4rem;
    }
    
    .fa-3x {
        font-size: 2.5rem;
    }
    
    .btn-block {
        display: block;
        width: 100%;
    }
    
    .card-header h5, .card-header h6 {
        font-weight: 600;
    }
    
    .list-unstyled li {
        padding: 2px 0;
    }
    
    .statistics-card {
        transition: all 0.3s ease;
    }
    
    .statistics-card:hover {
        transform: scale(1.05);
    }
    
    .list-group-item {
        border-left: none;
        border-right: none;
    }
    
    .list-group-item:first-child {
        border-top: none;
    }
    
    .list-group-item:last-child {
        border-bottom: none;
    }
</style>
{% endblock %}
